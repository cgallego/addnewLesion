1) Query to list all CAD_pt records with and associated procedure, 
 - monthsdiff is the difference in months between the imaging and the procedure ( should be in the [0,3] interval)
 - interimg calculates length of years from imaging to cutoff date '2015-05-05' 

SELECT 
  tbl_pt_mri_cad_record.cad_pt_no_txt, 
  tbl_pt_exam.exam_dt_datetime, 
  tbl_pt_exam.a_number_txt, 
  tbl_pt_exam.mri_cad_status_txt, 
  tbl_pt_procedure.proc_dt_datetime,
  (DATE_PART('year', tbl_pt_procedure.proc_dt_datetime) - DATE_PART('year', tbl_pt_exam.exam_dt_datetime)) * 12 +
              (DATE_PART('month', tbl_pt_procedure.proc_dt_datetime) - DATE_PART('month', tbl_pt_exam.exam_dt_datetime)) as monthsdiff,
  (DATE_PART('year', tbl_pt_exam.exam_dt_datetime) - DATE_PART('year', '2015-05-05'::date)) as interimg

FROM 
  public.tbl_pt_mri_cad_record, 
  public.tbl_pt_exam, 
  public.tbl_pt_procedure
WHERE 
  tbl_pt_mri_cad_record.pt_id = tbl_pt_exam.pt_id AND
  tbl_pt_procedure.pt_id = tbl_pt_exam.pt_id 
ORDER BY
  tbl_pt_mri_cad_record.cad_pt_no_txt ASC;


RESULTS: 9201 rows, on May 5, 2015
The result of this query is saved to file CADpt_records_w_procedure_monthsdiff.txt/.csv


-------
Number of patients in imaging interval = 940
[   2   16   18   22   25   27   29   37   66   68   77   93  102  103  111
  114  116  121  122  123  127  129  130  133  135  140  143  155  156  159
  165  167  168  170  171  172  173  177  178  180  182  186  189  190  196
  197  198  199  203  204  205  207  212  213  214  220  226  227  229  232
  233  245  246  248  249  252  260  261  266  271  272  276  277  280  286
  291  295  296  299  308  311  315  317  320  322  325  331  334  339  352
  353  355  357  361  363  366  372  375  376  381  383  384  388  393  396
  400  401  406  407  408  409  415  417  420  422  424  426  427  428  431
  433  436  438  440  442  444  454  455  456  460  462  463  465  469  473
  474  476  477  480  483  498  503  508  510  512  513  514  517  519  522
  529  533  536  537  542  545  547  550  551  552  556  560  561  562  566
  567  571  572  573  576  578  580  584  586  587  591  592  593  595  599
  603  604  606  608  613  615  616  619  624  635  642  645  651  657  662
  663  664  665  666  667  668  672  673  677  678  679  680  681  682  683
  684  685  687  689  690  691  692  696  700  705  706  707  710  713  714
  718  719  720  721  722  723  724  726  727  728  729  730  731  732  734
  735  736  737  740  742  743  744  745  747  748  752  755  757  758  760
  764  765  767  773  774  775  776  778  779  781  782  783  788  789  790
  791  792  793  794  795  796  799  800  802  803  805  807  809  810  812
  813  814  815  817  818  821  825  827  828  829  830  831  834  837  838
  839  840  843  844  845  846  847  850  851  852  853  856  857  858  860
  861  862  863  865  867  870  871  873  875  876  877  880  881  883  884
  885  887  888  896  897  898  899  900  904  913  918  920  921  922  923
  924  927  934  937  940  942  943  944  950  952  954  956  962  964  965
  966  967  974  975  977  978  979  980  981  985  993  995  997  999 1000
 1003 1004 1005 1006 1008 1012 1017 1018 1021 1022 1024 1025 1026 1027 1028
 1037 1041 1044 1045 1050 1053 1054 1057 1059 1062 1063 1064 1065 1071 1072
 1074 1077 1078 1079 1081 1086 1087 1088 1089 1090 1092 1093 1095 1099 2003
 2007 2014 2016 2017 2022 2023 2024 2025 2026 2027 2028 2029 2030 2032 2033
 2034 2035 2037 2038 2042 2043 2045 2046 2047 2048 2049 2050 2051 2052 2053
 2054 2055 2059 2060 2065 2068 2069 2070 2071 2072 2073 2074 2075 2077 2078
 2079 3000 3004 3005 3010 3011 3014 3017 3018 3019 3020 3021 3023 3025 3026
 3027 3028 3030 3031 3033 3035 3039 3041 3045 3046 3047 3052 3053 3054 3055
 3057 3060 3062 3063 3064 3065 3066 3067 3069 3070 3071 3072 3073 3074 3075
 3076 3077 3078 3080 3081 3082 3083 3084 3086 3091 3092 3093 3096 3097 4002
 4003 4008 4011 4012 4014 4015 4016 4017 4019 4020 4021 4023 4025 4026 4029
 4032 4033 4035 4039 4040 4041 4043 4044 4045 4047 4049 4050 4051 4052 4054
 4055 4059 4061 4062 4063 4064 4065 4066 4067 4068 4069 4071 4072 4073 4074
 4075 4076 4078 4079 4080 4081 4082 4084 4085 4086 4087 4089 4090 4092 4094
 4095 4096 4097 5001 5002 5003 5004 5005 5007 5009 5010 5012 5014 5015 5016
 5017 5022 5029 5030 5031 5032 5033 5034 5037 5039 5041 5042 5043 5044 5045
 5046 5049 5050 5051 5057 5059 5060 5061 5062 5063 5065 5067 5068 5073 5075
 5077 5087 5089 5094 5097 5099 6001 6003 6004 6005 6008 6010 6011 6013 6014
 6015 6016 6017 6018 6019 6020 6021 6022 6023 6024 6025 6026 6027 6028 6029
 6030 6032 6033 6034 6035 6036 6037 6038 6039 6040 6041 6042 6043 6044 6045
 6046 6047 6048 6049 6050 6051 6052 6053 6054 6055 6056 6057 6058 6059 6060
 6061 6062 6063 6064 6068 6069 6070 6071 6072 6073 6074 6075 6076 6077 6079
 6080 6081 6082 6083 6084 6085 6086 6087 6089 6090 6091 6092 6093 6094 6095
 6096 6097 6098 6099 6100 6101 6102 6103 6105 6107 6108 6109 6110 6112 6114
 6115 6116 6117 6122 6124 6128 6129 6130 6131 6132 6134 6138 6139 6140 6141
 6142 6143 6144 6145 6146 6148 6149 6150 6154 6155 6156 6158 6159 6160 6163
 6164 6165 6166 6169 6170 6171 6174 6176 6177 6179 6180 6183 6184 6186 6187
 6189 6191 6193 6195 6197 6199 6201 6202 6203 6206 6207 6209 6211 6212 6213
 6214 6215 6217 6218 6219 6220 6221 6223 6224 6226 6227 6228 6229 6233 6236
 6237 6238 6242 6243 6244 6247 6248 6250 6251 6253 6255 6256 6257 6259 6260
 6262 6263 6265 6267 6324 6327 6329 6335 6342 6360 7000 7001 7002 7003 7005
 7006 7007 7008 7010 7011 7012 7018 7019 7024 7025 7026 7027 7029 7030 7033
 7035 7036 7039 7043 7045 7053 7054 7055 7063 7065 7066 7067 7068 7074 7076
 7077 7085 7086 7087 7088 7089 7090 7091 7094 7096 7097 7099 7104 7105 7108
 7110 7116 7119 7127 7128 7136 7144 7145 7151 7152 7153 7154 7155 7156 7158
 7159 7160 7161 7162 7163 7165 7166 7168 7169 7170 7171 7172 7173 7175 7178
 7181 7182 7183 7184 7186 7188 7189 7190 7192 7193 7199 7201 7202 7205 7207
 7214 7220 7225 7227 7228 7229 7231 7232 7233 7234]

-------
Number of studies in imaging interval = 1428


a) first select cases where 
    - append to all list of patients in the time interval of the study (which you need to mention) *** reviewver comment
b) of those, add to accession list of imaging studies if imaging from [0-3] interval of procedure

The result of this filtering is saved to file CADpt_records_w_procedure_monthsdiff_within3months.txt

===================================================================================
2) In Spyder, run parse_queries.py this creates:
- 'lesions.csv' with a list aof all lesions
- also lists in python

Number of patients with a mass/nonmass BIRADS 3,4,5,6 in imaging interval = 760
-------
Number of patients in imaging interval = 760
['0002' '0016' '0018' '0022' '0025' '0027' '0066' '0068' '0102' '0103'
 '0111' '0114' '0121' '0122' '0123' '0127' '0133' '0135' '0140' '0143'
 '0155' '0165' '0168' '0171' '0172' '0173' '0177' '0178' '0180' '0186'
 '0189' '0190' '0196' '0197' '0199' '0203' '0205' '0207' '0212' '0220'
 '0227' '0229' '0232' '0233' '0246' '0248' '0249' '0252' '0261' '0266'
 '0271' '0272' '0276' '0277' '0280' '0296' '0299' '0308' '0320' '0325'
 '0331' '0334' '0339' '0352' '0353' '0355' '0357' '0361' '0363' '0366'
 '0372' '0375' '0376' '0381' '0383' '0384' '0388' '0393' '0396' '0400'
 '0406' '0407' '0408' '0409' '0415' '0420' '0422' '0424' '0426' '0427'
 '0428' '0431' '0436' '0438' '0440' '0442' '0454' '0455' '0456' '0460'
 '0462' '0463' '0465' '0469' '0473' '0474' '0476' '0483' '0498' '0503'
 '0508' '0510' '0513' '0514' '0519' '0522' '0529' '0536' '0537' '0542'
 '0545' '0550' '0551' '0552' '0556' '0560' '0561' '0562' '0566' '0567'
 '0571' '0572' '0573' '0576' '0578' '0580' '0586' '0587' '0591' '0592'
 '0593' '0595' '0599' '0603' '0604' '0606' '0608' '0613' '0616' '0619'
 '0624' '0635' '0642' '0645' '0651' '0657' '0663' '0664' '0665' '0666'
 '0667' '0668' '0672' '0673' '0677' '0679' '0681' '0682' '0683' '0684'
 '0685' '0687' '0690' '0691' '0692' '0696' '0700' '0705' '0707' '0710'
 '0713' '0714' '0718' '0719' '0720' '0721' '0722' '0723' '0724' '0726'
 '0727' '0728' '0729' '0730' '0731' '0732' '0734' '0735' '0736' '0737'
 '0740' '0742' '0743' '0744' '0745' '0747' '0748' '0752' '0755' '0757'
 '0758' '0760' '0764' '0765' '0767' '0776' '0778' '0779' '0781' '0782'
 '0789' '0790' '0791' '0792' '0793' '0794' '0795' '0796' '0799' '0802'
 '0803' '0805' '0807' '0809' '0810' '0812' '0813' '0814' '0815' '0817'
 '0827' '0828' '0829' '0830' '0831' '0834' '0837' '0838' '0839' '0840'
 '0843' '0844' '0845' '0846' '0847' '0850' '0851' '0852' '0853' '0856'
 '0857' '0861' '0862' '0863' '0865' '0867' '0870' '0871' '0875' '0876'
 '0877' '0880' '0883' '0884' '0885' '0887' '0888' '0896' '0897' '0898'
 '0900' '0904' '0918' '0921' '0922' '0924' '0927' '0934' '0937' '0942'
 '0943' '0944' '0950' '0952' '0954' '0962' '0965' '0967' '0975' '0978'
 '0985' '0993' '0995' '0997' '0999' '1003' '1004' '1006' '1008' '1012'
 '1018' '1021' '1024' '1025' '1026' '1027' '1044' '1045' '1050' '1053'
 '1054' '1057' '1059' '1062' '1063' '1064' '1065' '1071' '1072' '1077'
 '1078' '1079' '1081' '1086' '1087' '1090' '1092' '1095' '1099' '2003'
 '2007' '2016' '2017' '2023' '2024' '2025' '2027' '2028' '2029' '2033'
 '2035' '2042' '2043' '2045' '2046' '2047' '2048' '2049' '2050' '2051'
 '2053' '2055' '2059' '2065' '2068' '2069' '2070' '2071' '2072' '2073'
 '2074' '2075' '2078' '2079' '3000' '3004' '3005' '3010' '3011' '3017'
 '3018' '3020' '3021' '3023' '3025' '3028' '3030' '3031' '3033' '3035'
 '3039' '3041' '3045' '3046' '3053' '3054' '3055' '3057' '3062' '3063'
 '3064' '3065' '3066' '3067' '3069' '3070' '3071' '3072' '3073' '3074'
 '3075' '3076' '3077' '3078' '3080' '3081' '3082' '3083' '3084' '3086'
 '3091' '3092' '3093' '3096' '3097' '4002' '4003' '4008' '4011' '4012'
 '4015' '4017' '4019' '4020' '4021' '4023' '4025' '4026' '4032' '4039'
 '4040' '4041' '4043' '4044' '4045' '4047' '4049' '4050' '4054' '4055'
 '4059' '4061' '4062' '4064' '4065' '4066' '4068' '4069' '4071' '4072'
 '4075' '4076' '4078' '4079' '4080' '4081' '4082' '4084' '4085' '4086'
 '4090' '4092' '4094' '4095' '4096' '4097' '5001' '5002' '5004' '5005'
 '5007' '5009' '5010' '5014' '5015' '5016' '5022' '5029' '5030' '5031'
 '5032' '5033' '5037' '5039' '5042' '5043' '5044' '5046' '5049' '5050'
 '5051' '5059' '5060' '5062' '5063' '5065' '5067' '5068' '5073' '5075'
 '5077' '5087' '5089' '5094' '5097' '5099' '6001' '6003' '6005' '6008'
 '6011' '6013' '6014' '6015' '6016' '6018' '6019' '6020' '6021' '6022'
 '6023' '6024' '6025' '6026' '6027' '6029' '6030' '6032' '6033' '6034'
 '6035' '6036' '6037' '6038' '6039' '6040' '6041' '6042' '6043' '6044'
 '6045' '6046' '6047' '6048' '6049' '6050' '6051' '6052' '6053' '6054'
 '6055' '6056' '6057' '6058' '6059' '6060' '6061' '6062' '6063' '6064'
 '6068' '6069' '6070' '6071' '6072' '6073' '6075' '6077' '6079' '6080'
 '6081' '6082' '6083' '6084' '6085' '6086' '6087' '6089' '6090' '6091'
 '6092' '6094' '6095' '6096' '6097' '6098' '6099' '6100' '6101' '6102'
 '6103' '6105' '6107' '6108' '6109' '6110' '6112' '6114' '6115' '6116'
 '6124' '6128' '6129' '6130' '6134' '6139' '6140' '6143' '6145' '6148'
 '6150' '6154' '6155' '6156' '6158' '6163' '6164' '6165' '6169' '6170'
 '6171' '6174' '6179' '6180' '6183' '6184' '6186' '6187' '6189' '6191'
 '6197' '6199' '6201' '6202' '6203' '6206' '6207' '6209' '6211' '6212'
 '6214' '6215' '6217' '6218' '6219' '6220' '6223' '6224' '6226' '6227'
 '6229' '6233' '6236' '6237' '6238' '6242' '6243' '6244' '6247' '6248'
 '6251' '6253' '6256' '6257' '6262' '6327' '6335' '6342' '6360' '7000'
 '7001' '7002' '7006' '7008' '7010' '7012' '7018' '7019' '7024' '7025'
 '7026' '7027' '7029' '7030' '7033' '7035' '7036' '7053' '7063' '7065'
 '7066' '7067' '7068' '7074' '7076' '7077' '7085' '7086' '7087' '7088'
 '7089' '7094' '7096' '7097' '7099' '7104' '7105' '7110' '7116' '7119'
 '7127' '7128' '7145' '7151' '7153' '7154' '7155' '7156' '7158' '7159'
 '7160' '7161' '7162' '7163' '7165' '7166' '7168' '7169' '7171' '7172'
 '7173' '7175' '7181' '7182' '7183' '7184' '7189' '7190' '7192' '7193'
 '7199' '7201' '7202' '7214' '7220' '7225' '7227' '7229' '7231' '7232']


-------
Number of accesssions imaging interval = 941

-------
Number of lesions BIRADS 3,4,5,6 in imaging interval = 3297 (w duplicates)

-------
Number of patients with a mass/nonmass BIRADS 3,4,5,6 in imaging interval = 760
(array([  69.,    0.,    0.,  404.,    0.,    0.,  107.,    0.,    0.,  180.])